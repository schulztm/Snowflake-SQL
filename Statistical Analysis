--Get total count of rows/records
SELECT COUNT(*)
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY;
--https://docs.snowflake.com/en/sql-reference/functions/count

--Get total count of rows/records with unique values
SELECT COUNT(DISTINCT INV_ITEM_SK)
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY;

--Get total count of rows/records with missing values
SELECT COUNT(*)
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY
WHERE INV_ITEM_SK IS NULL;

--Combine all these into one query for ease :)
SELECT
    COUNT(*) AS TOTAL,
    COUNT(DISTINCT INV_ITEM_SK) AS Uniques,
    COUNT(CASE WHEN INV_ITEM_SK IS NULL THEN 1 END) AS Nulls,
    COUNT(CASE WHEN INV_ITEM_SK IS NULL THEN 1 END) / COUNT(*) as NullRate
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY;


--Create a Frequency Distribution Table, Ordered
SELECT
    INV_ITEM_SK AS Value,
    COUNT(*) AS Frequency
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY
GROUP BY INV_ITEM_SK
ORDER BY INV_ITEM_SK DESC;

--For numeric columns, we can also run statistics!
SELECT
    MIN(INV_ITEM_SK) AS Minimum,
    MAX(INV_ITEM_SK) AS Maximum,
    Maximum - Minimum AS Range,
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY;
--https://docs.snowflake.com/en/sql-reference/functions/min
--https://docs.snowflake.com/en/sql-reference/functions/max

SELECT
    AVG(INV_ITEM_SK) AS Mean,
    VAR_POP(INV_ITEM_SK) AS Variance,
    STDDEV_POP(INV_ITEM_SK) AS StandardDeviation
    --For this dataset, I'm simply assuming it's the whole population
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY;
--https://docs.snowflake.com/en/sql-reference/functions/avg
--https://docs.snowflake.com/en/sql-reference/functions/var_pop
--https://docs.snowflake.com/en/sql-reference/functions/stddev_pop
--https://docs.snowflake.com/en/sql-reference/functions/var_samp
--https://docs.snowflake.com/en/sql-reference/functions/stddev

SELECT
    MEDIAN(INV_ITEM_SK) AS Median,
    PERCENTILE_DISC(.25) WITHIN GROUP (ORDER BY INV_ITEM_SK) AS Q25,
    PERCENTILE_DISC(.75) WITHIN GROUP (ORDER BY INV_ITEM_SK) AS Q75,
    Q75 - Q25 AS IQR
    --For this dataset, I'm simply assuming it's discontinuous
FROM snowflake_sample_data.TPCDS_SF100TCL.INVENTORY;
--https://docs.snowflake.com/en/sql-reference/functions/median
--https://docs.snowflake.com/en/sql-reference/functions/percentile_cont
--https://docs.snowflake.com/en/sql-reference/functions/percentile_disc
